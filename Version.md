### История обновлений (CosmoCats)

Version 0.4.0
- Обновлён README.md: уточнены инструкции по установке, добавлены разделы о структуре проекта, участниках и использовании ИИ-инструментов.
- Улучшена обработка изображений в chat_manager.py: добавлен пропорциональный ресайз с max стороной 500px перед круглой обрезкой для ускорения загрузки.
- В index.html добавлен JS для асинхронной загрузки случайного кота с лоадером и обработкой ошибок.
- В platform.html добавлены лоадеры для аватаров чатов.
- В script.js улучшен CatGenerator: добавлены лоадер, обработка ошибок, анимация появления изображения.
- Мелкие фиксы: обновлены промпты ИИ для лучшего ролеплея, оптимизированы параметры генерации (temperature, top_p).
- Добавлена поддержка fallback-аватаров в случае ошибок с aleatori.cat.
- Созданы и улучшены дизайны вебстраниц index.html, base.html, login.html, register.html другими участниками.
- Исправлены предыдущие ошибки генерации изображений (круглая обрезка, сжатие PNG).
- Ускорена скорость отображения изображений путём оптимизации с Pillow (compress_level=9).
- Добавлены лоадеры и центрирование изображений в base.html (для аватаров и лого).
- Улучшена очистка ответов ИИ: обрезка до 1-2 предложений, добавление кошачьих элементов.
- Обновлён промпт ИИ для лучшего понимания роли Космокота.

Version 0.3.6
- Исправлены ошибки предыдущих версий.
- Исправлено отображение аватара пользователя.
- Добавлены темная и светлая темы.
- Добавлена поддержка `bfloat16` для уменьшения потребления памяти при инференсе.
- Исправлены ответы ИИ — корректная роль и контекст.
- Добавлен fallback при ошибках генерации, если модель не отвечает.
- Обновлён `requirements.txt`.

Version 0.3.0
- Добавлена локальная кеш-папка модели `model_cache` и логика загрузки модели в неё.
- Модель теперь загружается локально при наличии файлов в `model_cache` (без сети).
- При отсутствии локальных файлов модель скачивается в `model_cache` и затем переиспользуется.
- Модель загружается в режиме `eval()` с отключёнными градиентами — оптимизация для CPU.
- Ограничение контекста: при подаче в модель учитываются не более 5 последних сообщений пользователя и 5 последних ответов ассистента; суммарный объём пользовательского текста ограничен 5000 символов.
- Сохранение истории: при записи в БД чат хранит не более 5 user + 5 assistant сообщений (уменьшение размера БД).
- Добавлен эндпоинт `/random-cat` и UI-кнопка на главной странице для получения случайного изображения кота (TheCatAPI без ключа).
- Улучшен дизайн `index.html` (титульная карточка проекта) и добавлен JavaScript для отображения изображений.

Version 0.2.2
- Добавлен README.md с инструкциями по запуску и описанием функционала.
- Исправлен fallback-ответ ИИ: при невозможности сгенерировать ответ возвращается "у меня лапки, я не могу это сделать".
- Добавлена обработка ошибок при обращении к внешним сервисам (TheCatAPI) и в генерации ответов.

Version 0.2.1
- Добавлен фавикон `favcaticon.ico` и соответствующий маршрут.
- Мелкие правки в шаблонах и стилях, улучшена адаптивность.

Version 0.2.0
- Основная логика чата реализована: создание чатов, хранение истории, аватары чатов.
- Подключён модуль AI (`ai_core.py`) с использованием `transformers` и `torch` для локального инференса.

Version 0.1.9
- Интеграция Flask-Login для управления сессиями пользователей и защищённых маршрутов.

Version 0.1.8
- Добавлен менеджер профилей (`profile_manager.py`): смена имени, загрузка аватаров.

Version 0.1.6
- Реализация базы данных при помощи SQLAlchemy (модели `User`, `Chat`, сериализация истории).

Version 0.1.2
- Добавлены базовые шаблоны HTML (`index`, `login`, `register`) и статические ресурсы (CSS/JS).

Version 0.0.1
- Инициализация проекта и базовая структура модулей.

Замечания и рекомендации:
- Первичный запуск может занять время при скачивании и инициализации модели — это нормальное поведение.
- Для разработки можно временно включать заглушку AI, если загрузка модели слишком тяжёлая для машины.
- Для продакшна рекомендуется задать безопасный `SECRET_KEY` и использовать внешнюю СУБД вместо SQLite.
